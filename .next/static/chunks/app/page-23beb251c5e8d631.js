(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3168:function(e,t,a){Promise.resolve().then(a.bind(a,9375))},9375:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var n=a(7437),s=a(2265),r=a(8614),o=a(521),i=a(2718),l=a(5929),c=a(8623),d=a(1706),h=a(7226),u=a(2489),m=a(5978);let x=(0,a(738).ZF)({apiKey:"AIzaSyBQJcZPgf2hqDn7OWaD3H0Y2l5a2x61NOk",authDomain:"fir-15a95.firebaseapp.com",projectId:"fir-15a95",storageBucket:"fir-15a95.firebasestorage.app",messagingSenderId:"824813157601",appId:"1:824813157601:web:a338250b83d359c8bbcba0",measurementId:"G-NSMWTET0PR"}),g=(0,m.ad)(x),p=(0,a(3837).Z)(),b=[{name:"Default",from:"from-pink-200",to:"to-blue-300",button:"bg-pink-300"},{name:"Sunset",from:"from-orange-200",to:"to-pink-300",button:"bg-orange-300"},{name:"Ocean",from:"from-blue-200",to:"to-teal-300",button:"bg-blue-300"},{name:"Forest",from:"from-green-200",to:"to-emerald-300",button:"bg-green-300"}],f=["I'm feeling anxious","I need motivation","I'm having trouble sleeping","I want to improve my mood"];function y(){let[e,t]=(0,s.useState)([]),[a,x]=(0,s.useState)(null),[y,w]=(0,s.useState)([]),[v,j]=(0,s.useState)(""),[N,S]=(0,s.useState)(""),[E,I]=(0,s.useState)(!1),[C,k]=(0,s.useState)(""),[D,T]=(0,s.useState)(0),[P,O]=(0,s.useState)(0),[J,A]=(0,s.useState)(0),[z,B]=(0,s.useState)(!1),[_,Z]=(0,s.useState)(!1),[H,F]=(0,s.useState)(b[0]),[M,U]=(0,s.useState)(!1),[Q,R]=(0,s.useState)(!1),[Y,q]=(0,s.useState)(!1),[K,L]=(0,s.useState)(null),W=(0,s.useRef)(null),[G,X]=(0,s.useState)(!1);(0,s.useEffect)(()=>{console.log("Firebase initialized:",g.app.options.projectId),console.log("Firebase Config:",{apiKey:'"AIzaSyBQJcZPgf2hqDn7OWaD3H0Y2l5a2x61NOk",'.substring(0,5)+"*",projectId:'"fir-15a95",',appId:'"1:824813157601:web:de1eafa405750f12bbcba0",'}),$(),ee()},[]);let V=async e=>{try{let t=(0,m.JU)(g,"userData",e),a=await (0,m.QT)(t);if(a.exists())return a.data();return null}catch(e){return console.error("Error retrieving user data:",e),null}},$=async()=>{try{let e=await fetch("/api/daily-quote"),t=await e.json();S(t.quote)}catch(e){console.error("Error fetching daily quote:",e),S("Every day is a new beginning.")}},ee=async()=>{let e=(0,m.IO)((0,m.hJ)(g,"conversations"),(0,m.Xo)("createdAt","desc")),a=(await (0,m.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));t(a),a.length>0&&x(a[0].id)};(0,s.useEffect)(()=>{if(a){let e=(0,m.IO)((0,m.hJ)(g,"conversations",a,"messages"),(0,m.Xo)("timestamp","asc")),t=(0,m.cf)(e,e=>{w(e.docs.map(e=>{let t=e.data();return{role:t.role,content:t.content}}))});return()=>t()}},[a]);let et=async()=>{let e=(0,m.JU)((0,m.hJ)(g,"conversations"));await (0,m.pl)(e,{createdAt:(0,m.Bt)()}),x(e.id),await ee()},ea=async e=>{if(e.preventDefault(),!v.trim())return;eo(v)&&(R(!0),await ei(p,v));let t=[...y,{role:"user",content:v}];w(t),j(""),q(!0),L(null),X(!0),w([...t,{role:"assistant",content:"Irene is thinking..."}]);try{let e=await es(v),n=await er("The user's message has a \"".concat(e,'" sentiment. Respond appropriately. User: ').concat(v),y,p);n&&(w([...t,{role:"assistant",content:n}]),a&&(await (0,m.ET)((0,m.hJ)(g,"conversations",a,"messages"),{role:"user",content:v,timestamp:(0,m.Bt)()}),await (0,m.ET)((0,m.hJ)(g,"conversations",a,"messages"),{role:"assistant",content:n,timestamp:(0,m.Bt)()})))}catch(e){console.error("Error processing message:",e),L("I'm having trouble connecting. Please try again in a moment.")}finally{q(!1),X(!1)}},en=async e=>{let t=[...y,{role:"user",content:e}];w(t),q(!0),L(null),X(!0),w([...t,{role:"assistant",content:"Irene is thinking..."}]);try{let n=await es(e),s=await er("The user's message has a \"".concat(n,'" sentiment. Respond appropriately. User: ').concat(e),y,p);s&&(w([...t,{role:"assistant",content:s}]),a&&(await (0,m.ET)((0,m.hJ)(g,"conversations",a,"messages"),{role:"user",content:e,timestamp:(0,m.Bt)()}),await (0,m.ET)((0,m.hJ)(g,"conversations",a,"messages"),{role:"assistant",content:s,timestamp:(0,m.Bt)()})))}catch(e){console.error("Error in handleQuickReply:",e),L("I'm having trouble connecting. Please try again in a moment.")}finally{q(!1),X(!1)}},es=async e=>{try{let t=await fetch("https://bda6a3fc652c929291.gradio.live/api/predict",{method:"POST",headers:{"Content-Type":"application/json",Origin:window.location.origin},body:JSON.stringify({data:[e]})});if(!t.ok)throw Error("HTTP error! Status: ".concat(t.status));return(await t.json()).data[0]}catch(e){return console.error("Error calling Gradio API:",e),"neutral"}},er=async(e,t,a)=>{let n="AIzaSyD8KhDYQKS8P_4SwmSkN3FQG02yAIcZ9iU";if(!n)return L("API key not configured"),null;let s=await V(a),r=(null==s?void 0:s.name)||"User",o=(null==s?void 0:s.behavior)||"neutral",i=(null==s?void 0:s.tone)||"neutral",l=(null==s?void 0:s.problems)||[],c=t.map(e=>"".concat("user"===e.role?"User":"Irene",": ").concat(e.content)).join("\n"),d="You are Irene, a mental health companion. Respond in a short, conversational, and empathetic tone, like a caring friend on WhatsApp. Keep it under 2-3 sentences. Be warm and lovely, but also provide actionable solutions to the user's problem. Here's the conversation history:\n".concat(c,"\n").concat(e);r&&(d+="\nNote: The user's name is ".concat(r,".")),o&&(d+="\nThe user's recent behavior has been ".concat(o,".")),i&&(d+="\nThe user's tone is ".concat(i,".")),l.length>0&&(d+="\nThe user has mentioned the following problems: ".concat(l.join(", "),"."));try{let e=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}]})});if(!e.ok)throw Error("API error: ".concat(e.status," ").concat(e.statusText));return(await e.json()).candidates[0].content.parts[0].text}catch(e){return console.error("API Error:",e),L("Oops! Something went wrong. Let's try again."),null}},eo=e=>["suicide","kill myself","harm myself","hurt myself","end my life","want to die","self-harm","abuse","violence","hate","murder"].some(t=>e.toLowerCase().includes(t)),ei=async(e,t)=>{try{let a=(0,m.hJ)(g,"flaggedMessages");await (0,m.ET)(a,{userId:e,message:t,timestamp:(0,m.Bt)()}),console.log("Flagged message saved to Firestore.")}catch(e){console.error("Error saving flagged message:",e)}},el=()=>{k("Inhale"),T(4);let e=setInterval(()=>{T(t=>t>1?t-1:(clearInterval(e),ec(),0))},1e3)},ec=()=>{k("Hold"),T(7);let e=setInterval(()=>{T(t=>t>1?t-1:(clearInterval(e),ed(),0))},1e3)},ed=()=>{k("Exhale"),T(8);let e=setInterval(()=>{T(t=>t>1?t-1:(clearInterval(e),O(e=>e+1),A(e=>e+19),E&&el(),0))},1e3)},eh=()=>{I(!1),k(""),T(0)},eu=e=>{F(e)};return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col ".concat(_?"bg-gray-900 text-white":"bg-gradient-to-br ".concat(H.from," ").concat(H.to)),children:[(0,n.jsx)("audio",{ref:W,src:"https://www.chosic.com/download-audio/27279/",loop:!0,autoPlay:!0}),(0,n.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-8 flex flex-col md:flex-row gap-8 items-center justify-center min-h-screen",children:[(0,n.jsxs)("div",{className:"w-full md:w-1/3 space-y-6",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-6xl font-bold text-indigo-600 mb-2 font-['Comic_Sans_MS', 'Chalkboard_SE', 'sans-serif']",children:"Irene"}),(0,n.jsx)("p",{className:"text-2xl text-indigo-500 font-['Comic_Sans_MS', 'Chalkboard_SE', 'sans-serif']",children:"Your Companion of Care"})]}),(0,n.jsxs)("div",{className:"rounded-2xl p-6 shadow-lg ".concat(_?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-2 text-indigo-500",children:"Daily Vibe"}),(0,n.jsx)("p",{className:"text-lg italic",children:N}),(0,n.jsx)("span",{className:"text-3xl mt-2 block",children:"✨"})]}),(0,n.jsxs)("div",{className:"rounded-2xl p-6 shadow-lg ".concat(_?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-2 text-indigo-500",children:"Breathe Easy"}),E?(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(o.E.div,{animate:{scale:"Inhale"===C?1.2:"Exhale"===C?.8:1},transition:{duration:"Hold"===C?7:4},className:"text-6xl mb-2",children:"Inhale"===C?"\uD83E\uDEC1":"Exhale"===C?"\uD83D\uDE2E‍\uD83D\uDCA8":"\uD83D\uDE0C"}),(0,n.jsx)("p",{className:"text-lg font-medium",children:C}),(0,n.jsx)("p",{className:"text-2xl font-bold mt-2",children:D}),(0,n.jsxs)("p",{className:"text-sm mt-2",children:["Cycles: ",P]}),(0,n.jsxs)("p",{className:"text-sm",children:["Total Time: ",J,"s"]}),(0,n.jsx)("button",{onClick:eh,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded-full hover:bg-red-600 transition duration-300",children:"Stop"})]}):(0,n.jsx)("button",{onClick:()=>{I(!0),O(0),A(0),el()},className:"bg-indigo-500 text-white px-4 py-2 rounded-full hover:bg-indigo-600 transition duration-300",children:"Start Breathing"})]})]}),(0,n.jsx)("div",{className:"w-full md:w-1/3",children:(0,n.jsx)("div",{className:"rounded-3xl shadow-lg overflow-hidden ".concat(_?"bg-gray-800":"bg-white bg-opacity-70"),children:(0,n.jsxs)("div",{className:"h-[calc(100vh-200px)] flex flex-col",children:[(0,n.jsx)("div",{className:"flex-grow overflow-y-auto p-6 space-y-4 scrollbar-thin scrollbar-thumb-indigo-500 scrollbar-track-transparent",children:y.map((e,t)=>(0,n.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,n.jsx)("div",{className:"max-w-xs md:max-w-md rounded-2xl p-3 ".concat("user"===e.role?"".concat(_?"bg-indigo-600":"bg-indigo-500"," text-white"):"".concat(_?"bg-gray-700":"bg-gray-200"," ").concat(_?"text-white":"text-gray-800")),children:e.content})},t))}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mb-2 px-4",children:f.map((e,t)=>(0,n.jsx)("button",{onClick:()=>en(e),className:"bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm hover:bg-indigo-200 transition duration-300",disabled:Y,children:e},t))}),(0,n.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,n.jsxs)("form",{onSubmit:ea,className:"flex rounded-full overflow-hidden shadow-lg",children:[(0,n.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),placeholder:"Share your thoughts...",className:"flex-grow p-3 focus:outline-none ".concat(_?"bg-gray-700 text-white":"bg-gray-100 text-gray-800")}),(0,n.jsx)("button",{type:"submit",className:"bg-indigo-500 text-white px-6 py-3 hover:bg-indigo-600 transition duration-300",children:"Send"})]})})]})})}),(0,n.jsxs)("div",{className:"w-full md:w-1/3 space-y-4",children:[(0,n.jsxs)("button",{onClick:()=>{et(),w([])},className:"w-full px-4 py-2 rounded-full bg-green-500 text-white hover:bg-green-600 transition duration-300 flex items-center justify-center",children:[(0,n.jsx)(i.Z,{className:"mr-2",size:20}),"New Chat"]}),(0,n.jsxs)("div",{className:"rounded-2xl p-4 shadow-lg ".concat(_?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4 text-indigo-500",children:"Conversation History"}),(0,n.jsx)("div",{className:"space-y-2 max-h-[calc(100vh-300px)] overflow-y-auto",children:e.map((t,s)=>(0,n.jsxs)("button",{onClick:()=>{x(t.id);let e=(0,m.IO)((0,m.hJ)(g,"conversations",t.id,"messages"),(0,m.Xo)("timestamp","asc"));(0,m.PL)(e).then(e=>{w(e.docs.map(e=>({role:e.data().role,content:e.data().content})))})},className:"w-full px-4 py-2 rounded-full text-left ".concat(a===t.id?"bg-indigo-500 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300"),children:["Chat ",e.length-s," "]},t.id))})]})]})]}),(0,n.jsxs)("div",{className:"fixed top-4 right-4 flex space-x-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{onClick:()=>U(!M),className:"p-2 rounded-full ".concat(_?"bg-gray-700 text-white":"bg-white text-gray-800"," hover:bg-opacity-80 transition duration-300"),children:(0,n.jsx)(l.Z,{size:24})}),M&&(0,n.jsx)("div",{className:"absolute right-0 mt-2 p-2 rounded-lg shadow-lg ".concat(_?"bg-gray-800":"bg-white"),children:b.map(e=>(0,n.jsx)("button",{onClick:()=>eu(e),className:"w-6 h-6 rounded-full ".concat(e.button," border-2 ").concat(H===e?"border-indigo-500":"border-transparent"," m-1"),"aria-label":"Set ".concat(e.name," theme")},e.name))})]}),(0,n.jsx)("button",{onClick:()=>{B(!z),W.current&&(W.current.muted=!W.current.muted)},className:"p-2 rounded-full ".concat(_?"bg-gray-700 text-white":"bg-white text-gray-800"," hover:bg-opacity-80 transition duration-300"),children:z?(0,n.jsx)(c.Z,{size:24}):(0,n.jsx)(d.Z,{size:24})}),(0,n.jsx)("button",{onClick:()=>{Z(!_)},className:"p-2 rounded-full ".concat(_?"bg-gray-700 text-white":"bg-white text-gray-800"," hover:bg-opacity-80 transition duration-300"),children:_?(0,n.jsx)(l.Z,{size:24}):(0,n.jsx)(h.Z,{size:24})})]}),(0,n.jsx)(r.M,{children:E&&(0,n.jsx)(o.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"p-8 rounded-3xl ".concat(_?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-indigo-500",children:"Breathe with Me"}),(0,n.jsx)("button",{onClick:eh,className:"text-gray-500 hover:text-gray-700","aria-label":"Close breathing exercise",children:(0,n.jsx)(u.Z,{size:24})})]}),(0,n.jsx)(o.E.div,{animate:{scale:"Inhale"===C?1.2:"Exhale"===C?.8:1},transition:{duration:"Hold"===C?7:4},className:"text-9xl text-center mb-4",children:"Inhale"===C?"\uD83E\uDEC1":"Exhale"===C?"\uD83D\uDE2E‍\uD83D\uDCA8":"\uD83D\uDE0C"}),(0,n.jsx)("p",{className:"text-2xl font-medium text-center mb-2",children:C}),(0,n.jsx)("p",{className:"text-4xl font-bold text-center mb-4",children:D}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("p",{className:"text-lg",children:["Cycles completed: ",P]}),(0,n.jsxs)("p",{className:"text-lg",children:["Total time: ",J,"s"]})]})]})})}),(0,n.jsx)(r.M,{children:Q&&(0,n.jsx)(o.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"p-8 rounded-3xl ".concat(_?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:"Alert!"}),(0,n.jsx)("p",{className:"text-lg mb-4",children:"You need help and we have sent your info to the nearest help provider. Please be safe, you matter."}),(0,n.jsx)("button",{onClick:()=>R(!1),className:"bg-red-500 text-white px-4 py-2 rounded-full hover:bg-red-600 transition duration-300",children:"Close"})]})})})]})}}},function(e){e.O(0,[358,603,971,117,744],function(){return e(e.s=3168)}),_N_E=e.O()}]);